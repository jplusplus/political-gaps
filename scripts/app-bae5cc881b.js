(function(){angular.module("politicalGaps",["ngAnimate","ngTouch","ngSanitize","ngMessages","ngAria","restangular","ui.router","ui.bootstrap"])}).call(this),function(){angular.module("politicalGaps").service("webDevTec",function(){"ngInject";var t,e;t=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Bootstrap",url:"http://getbootstrap.com/",description:"Bootstrap is the most popular HTML, CSS, and JS framework for developing responsive, mobile first projects on the web.",logo:"bootstrap.png"},{title:"Angular UI Bootstrap",url:"http://angular-ui.github.io/bootstrap/",description:"Bootstrap components written in pure AngularJS by the AngularUI Team.",logo:"ui-bootstrap.png"},{title:"Sass (Node)",url:"https://github.com/sass/node-sass",description:"Node.js binding to libsass, the C version of the popular stylesheet preprocessor, Sass.",logo:"node-sass.png"},{title:"CoffeeScript",url:"http://coffeescript.org/",description:"CoffeeScript, 'a little language that compiles into JavaScript'.",logo:"coffeescript.png"}],e=function(){return t},this.getTec=e})}.call(this),function(){angular.module("politicalGaps").directive("navbar",function(){var t;return t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controllerAs:"vm",bindToController:!0}})}.call(this),function(){angular.module("politicalGaps").service("cluster",function(){return function(t,e,i){return null==i&&(i=10),function(e){var n,r,a,s,o;return n=clusters[e.cluster],n!==e?(s=e.x-n.x,o=e.y-n.y,r=Math.sqrt(s*s+o*o),a=i+n.radius,r!==a?(r=(r-a)/r*t,e.x-=s*=r,e.y-=o*=r):void 0):void 0}}}).service("collide",function(){return function(t,e,i){var n,r;return null==i&&(i=15),n=2,r=d3.geom.quadtree(e),function(e){var a,s,o,l,u;return u=10,a=e.x-u,s=e.x+u,o=e.y-u,l=e.y+u,r.visit(function(r,c,h,p,g){var m,f,d;return r.point&&r.point!==e&&(f=e.x-r.point.x,d=e.y-r.point.y,m=Math.sqrt(f*f+d*d),u=NODE_RADIUS+r.point.radius+(e.cluster===r.point.cluster?n:i),u>m&&(m=(m-u)/m*t,e.x-=f*=m,e.y-=d*=m,r.point.x+=f,r.point.y+=d)),c>s||a>p||h>l||o>g})}}})}.call(this),function(){angular.module("politicalGaps").directive("acmeMalarkey",function(){var t,e,i;return t=["$log","githubContributor",function(t,e){"ngInject";var i,n,r;r=this,i=function(){return n().then(function(){t.info("Activated Contributors View")})},n=function(){return e.getContributors(10).then(function(t){return r.contributors=t,r.contributors})},r.contributors=[],i()}],i=function(t,e,i,n){var r,a;a=void 0,r=malarkey(e[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "}),e.addClass("acme-malarkey"),angular.forEach(t.extraValues,function(t){r.type(t).pause()["delete"]()}),a=t.$watch("vm.contributors",function(){angular.forEach(n.contributors,function(t){r.type(t.login).pause()["delete"]()})}),t.$on("$destroy",function(){a()})},e={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:i,controller:t,controllerAs:"vm"}})}.call(this),function(){angular.module("politicalGaps").factory("githubContributor",["$log","$http",function(t,e){"ngInject";var i,n,r;return i="https://api.github.com/repos/Swiip/generator-gulp-angular",n=function(n){var r,a;return null==n&&(n=30),r=function(t){return t.data},a=function(e){t.error("XHR Failed for getContributors.\n"+angular.toJson(e.data,!0))},e.get(i+"/contributors?per_page="+n).then(r)["catch"](a)},r={apiHost:i,getContributors:n}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};angular.module("politicalGaps").directive("mainChart",["topics",function(e){"ngInject";return{scope:{mainChart:"=",topic:"="},link:function(i,n,r){var a;return new(a=function(){function r(){this.forceTicked=t(this.forceTicked,this),this.countWithData=t(this.countWithData,this),this.countNoData=t(this.countNoData,this),this.count=t(this.count,this),this.createLegend=t(this.createLegend,this),this.startSimulation=t(this.startSimulation,this),this.groupFrom=t(this.groupFrom,this),this.groups=t(this.groups,this),this.buildPerson=t(this.buildPerson,this),this.scaleX=t(this.scaleX,this),this.datum=t(this.datum,this),this.force=t(this.force,this),this.getSizes=t(this.getSizes,this),this.height=t(this.height,this),this.width=t(this.width,this),this.svg=this.el.append("svg"),this.legend=this.el.append("div").attr("class","main__chart__legend"),this.people=this.svg.append("g").attr("class","main__chart__people"),i.$watch("topic",function(t){return function(){return t.startSimulation()&&t.createLegend()}}(this))}return r.prototype._groups={},r.prototype.summary=i.mainChart.global,r.prototype.el=d3.select(n[0]),r.prototype.width=function(){return this._width=this._width||function(t){return function(){return t.getSizes()[0]}}(this)()},r.prototype.height=function(){return this._height=this._height||function(t){return function(){return t.getSizes()[1]}}(this)()},r.prototype.getSizes=function(){return[angular.element(n).width(),angular.element(n).height()]},r.prototype.force=function(){return this._force=this._force||function(t){return function(){return d3.forceSimulation().force("charge",d3.forceManyBody().strength(-1)).force("x",d3.forceX(function(t){return t().forceX()})).force("y",d3.forceY(function(t){return t().forceY()})).on("tick",t.forceTicked)}}(this)()},r.prototype.datum=function(){return this._datum=this._datum||function(t){return function(){var e,i,n,r;for(r=[],e=i=0,n=t.summary.total-1;n>=0?n>=i:i>=n;e=n>=0?++i:--i)r.push(t.buildPerson(e));return r}}(this)()},r.prototype.scaleX=function(){var t,e;return e=this.width()/this.groups().length*.5,t=this.width()-e,d3.scaleLinear().range([0,1]).range([e,t])},r.prototype.buildPerson=function(t){return function(e){return function(){var i;return i=e.groupFrom(t),{group:i,id:t,forceY:function(){return e.height()/2},forceX:function(){var n;return null==i?e.scaleX()(1):(n=e.groups().indexOf(e.groupFrom(t)),e.scaleX()(n/(e.groups().length-1)))},"class":function(){var n,r;return r=["main__chart__people__node","main__chart__people__node"],null!=i?(n=e.groups().indexOf(e.groupFrom(t)),r.push("main__chart__people__node--"+slug(i.toLowerCase())),r.push("main__chart__people__node--"+n)):r.push("main__chart__people__node--no-data"),r.join(" ")}}}}(this)},r.prototype.groups=function(t){return null==t&&(t=i.topic),this._groups[t]=this._groups[t]||function(i){return function(){var n;return n=_.chain(i.summary[t]).keys().filter(function(t){return i.count(t)>0}).sortBy(function(n){var r,a;return null!=(null!=(r=e[t].groups[n])?r.order:void 0)?null!=(a=e[t].groups[n])?a.order:void 0:i.summary[t][n]}).value(),i.countNoData()>0&&n.push("No data"),n}}(this)()},r.prototype.groupFrom=function(t,e){var n,r;return null==e&&(e=i.topic),r=0,n=null,_.each(this.groups(e),function(i){return function(a){return t>=r&&t<r+i.summary[e][a]&&(n=a),r+=i.summary[e][a]}}(this)),n},r.prototype.startSimulation=function(){var t;return this.nodes=this.people.selectAll(".main__chart__people__node").data(this.datum(),function(t){return t().id}).attr("class",function(t){return t()["class"]()}),t=this.nodes.enter().append("circle").attr("r",3).attr("class",function(t){return t()["class"]()}),this.nodes=t.merge(this.nodes),this.force().nodes(this.datum()),this.force().alphaTarget(2).restart()},r.prototype.createLegend=function(){var t;return t=this.legend.selectAll(".main__chart__legend__group").data(this.groups()),t.enter().append("div").attr("class","main__chart__legend__group").merge(t).html(function(t){return function(n){var r;return["<div>"+((null!=(r=e[i.topic].groups[n])?r.label:void 0)||n)+"</div>",Math.round(1e4*t.count(n)/t.summary.total)/100+"%"].join("")}}(this)),t.exit().remove()},r.prototype.count=function(t){return this.summary[i.topic][t]||this.countNoData()},r.prototype.countNoData=function(){return this.summary.total-this.countWithData()},r.prototype.countWithData=function(){return _.chain(this.summary[i.topic]).values().sum().value()},r.prototype.forceTicked=function(){return this.nodes.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})},r}())}}}])}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};angular.module("politicalGaps").controller("MainController",["summary","countries","legislatures","$state","$stateParams","legislature_id","$scope",function(e,i,n,r,a,s,o){"ngInject";var l;return new(l=function(){function i(){this.buildFilters=t(this.buildFilters,this),this.getFilteredLegislatures=t(this.getFilteredLegislatures,this),this.buildFilteredLegislatures=t(this.buildFilteredLegislatures,this),this.isFiltered=t(this.isFiltered,this),this.toggleFrom=t(this.toggleFrom,this),this.toggleTerm=t(this.toggleTerm,this),this.toggleDifficultyLevel=t(this.toggleDifficultyLevel,this),this.toggleCountryAlpha2=t(this.toggleCountryAlpha2,this),this.matchTerm=t(this.matchTerm,this),this.matchDifficultyLevel=t(this.matchDifficultyLevel,this),this.matchCountryAlpha2=t(this.matchCountryAlpha2,this),this.isTerm=t(this.isTerm,this),this.isDifficultyLevel=t(this.isDifficultyLevel,this),this.isCountryAlpha2=t(this.isCountryAlpha2,this),this.getTerm=t(this.getTerm,this),this.getDifficultyLevel=t(this.getDifficultyLevel,this),this.getCountryAlpha2=t(this.getCountryAlpha2,this),this.hasTerm=t(this.hasTerm,this),this.hasDifficultyLevel=t(this.hasDifficultyLevel,this),this.hasCountryAlpha2=t(this.hasCountryAlpha2,this),this.resetTerm=t(this.resetTerm,this),this.resetDifficultyLevel=t(this.resetDifficultyLevel,this),this.resetCountryAlpha2=t(this.resetCountryAlpha2,this),this.uiOnParamsChanged=t(this.uiOnParamsChanged,this),this.buildFilters(),o.$watch("main.legislature",function(t,e){return t!==e?r.go("main",{legislature_id_eq:t}):void 0})}return i.prototype._countryAlpha2=[],i.prototype._difficultyLevel=[],i.prototype._term=[],i.prototype.__legislatures=[],i.prototype.summary=e,i.prototype.legislatures=n,i.prototype.legislature=1*s,i.prototype.topic=a.topic,i.prototype.administrativeLevels=["National","Regional","Local"],i.prototype.uiOnParamsChanged=function(t,e){return this.topic=t.topic},i.prototype.resetCountryAlpha2=function(){return this._countryAlpha2=[],this.buildFilteredLegislatures()},i.prototype.resetDifficultyLevel=function(){return this._difficultyLevel=[],this.buildFilteredLegislatures()},i.prototype.resetTerm=function(){return this._term=[],this.buildFilteredLegislatures()},i.prototype.hasCountryAlpha2=function(){return this._countryAlpha2.length},i.prototype.hasDifficultyLevel=function(){return this._difficultyLevel.length},i.prototype.hasTerm=function(){return this._term.length},i.prototype.getCountryAlpha2=function(){return this._countryAlpha2},i.prototype.getDifficultyLevel=function(){return this._difficultyLevel},i.prototype.getTerm=function(){return this._term},i.prototype.isCountryAlpha2=function(t){return this._countryAlpha2.indexOf(t)>-1},i.prototype.isDifficultyLevel=function(t){return this._difficultyLevel.indexOf(t)>-1},i.prototype.isTerm=function(t){return this._term.indexOf(t)>-1},i.prototype.matchCountryAlpha2=function(t){return _.some(this.getFilteredLegislatures(),function(e){return e.country.alpha2===t})},i.prototype.matchDifficultyLevel=function(t){return _.some(this.getFilteredLegislatures(),{difficulty_level:t})},i.prototype.matchTerm=function(t){return _.some(this.getFilteredLegislatures(),{term:t})},i.prototype.toggleCountryAlpha2=function(t){return this.toggleFrom(this._countryAlpha2,t)},i.prototype.toggleDifficultyLevel=function(t){return this.toggleFrom(this._difficultyLevel,t)},i.prototype.toggleTerm=function(t){return this.toggleFrom(this._term,t)},i.prototype.toggleFrom=function(t,e){var i;return i=t.indexOf(e),-1===i?t.push(e):t.splice(i,1),this.buildFilteredLegislatures()},i.prototype.isFiltered=function(t){var e;return e=!0,e&&(e=!this.hasCountryAlpha2()||this.isCountryAlpha2(t.country.alpha2)),e&&(e=!this.hasDifficultyLevel()||this.isDifficultyLevel(t.difficulty_level)),e&&(e=!this.hasTerm()||this.isTerm(t.term)),e},i.prototype.buildFilteredLegislatures=function(){return this.__legislatures=_.filter(n,this.isFiltered)},i.prototype.getFilteredLegislatures=function(){return this.__legislatures},i.prototype.buildFilters=function(){return this.countries=_.chain(n).map("country").uniq().sortBy(function(t){return t.name}).value(),this.difficultyLevels=_.chain(n).map("difficulty_level").uniq().sort().value(),this.terms=_.chain(n).map("term").uniq().sort().reverse().value(),this.buildFilteredLegislatures()},i}())}])}.call(this),function(){angular.module("politicalGaps").run(["$log",function(t){"ngInject";return t.debug("runBlock end")}])}.call(this),function(){angular.module("politicalGaps").config(["$stateProvider","$urlRouterProvider",function(t,e){"ngInject";return e.otherwise("/"),t.state("main",{url:"/:legislature_id_eq",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main",params:{legislature_id_eq:{value:null},topic:{dynamic:!0,value:"gender"}},resolve:{countries:["$http",function(t){return t.get("data/countries.json").then(function(t){return t.data})}],legislatures:["$http","countries",function(t,e){return t.get("data/legislatures.json").then(function(t){var i,n,r,a;for(a=t.data,i=0,r=a.length;r>i;i++)n=a[i],n.end_date=new Date(n.end_date),n.start_date=new Date(n.start_date),n.country=_.find(e,{alpha2:n.country}),n.term=n.start_date.getFullYear()+"-"+n.end_date.getFullYear(),n.display_name=n.name,n.display_name+=" - ",n.display_name+="Completion rate: ",n.display_name+=~~(1e3*n.completion)/10,n.display_name+="%";return t.data})}],legislature_id:["$stateParams","legislatures",function(t,e){return t.legislature_id_eq||e[0].id}],summary:["$http","legislature_id",function(t,e){return t.get("data/summary-"+e+".json").then(function(t){return t.data})}]}})}])}.call(this),function(){angular.module("politicalGaps").constant("topics",{gender:{groups:{male:{label:"Male"},female:{label:"Female"},other:{label:"Other"}}},age_range:{groups:{"bellow-30":{label:"Under 30",order:0},"30-40":{label:"30 to 40",order:1},"40-50":{label:"40 to 50",order:2},"50-60":{label:"50 to 60",order:3},"60-70":{label:"60 to 70",order:4},"over-70":{label:"Over 70",order:5}}},political_leaning:{groups:{"Left wing":{},"Center-left (social democrat)":{},Green:{},"Center (liberal)":{},Conservative:{},"Far-right":{},Other:{}}},profession_category:{groups:{"Armed forces":{},"Private sector professional":{},"Civil servant":{},Farmer:{},"Journalist, public relations":{},Lawyer:{},"Manual worker, craftsman/woman":{},"Medical doctor, dentist, optician":{},Miner:{},Teacher:{},"University professor":{},Student:{},"No occupation":{},Other:{}}}})}.call(this),function(){angular.module("politicalGaps").config(["$logProvider","RestangularProvider",function(t,e){"ngInject";return t.debugEnabled(!0),e.setBaseUrl("http://www.jquestapp.com/political-gaps/api/v1/"),e.setRestangularFields({selfLink:"@id"})}])}.call(this),angular.module("politicalGaps").run(["$templateCache",function(t){t.put("app/main/main.html",'<div class=main><form class=main__elastic><div class=container><div class=row><div class=col-xs-4><div class=card><h4 class="card-heading main__elastic__title"><button class="btn btn-link btn-sm pull-xs-right" ng-click=main.resetCountryAlpha2() ng-if=main.hasCountryAlpha2()>All</button> Country</h4><ul class="list-unstyled main__elastic__list main__elastic__list--country"><li ng-repeat="country in ::main.countries"><button class="btn btn-primary btn-xs btn-block main__elastic__list__item" ng-click=main.toggleCountryAlpha2(country.alpha2) ng-class="{\n                          \'main__elastic__list__item--active\': main.isCountryAlpha2(country.alpha2),\n                          \'main__elastic__list__item--reduced\': !main.matchCountryAlpha2(country.alpha2)\n                        }">{{ country.name }}</button></li></ul></div></div><div class=col-xs-4><div class=card><h4 class="card-heading main__elastic__title"><button class="btn btn-link btn-sm pull-xs-right" ng-click=main.resetDifficultyLevel() ng-if=main.hasDifficultyLevel()>All</button> Administrative level</h4><ul class="list-unstyled main__elastic__list main__elastic__list--administrative-level"><li ng-repeat="difficultyLevel in ::main.difficultyLevels"><button class="btn btn-primary btn-xs btn-block main__elastic__list__item" ng-click=main.toggleDifficultyLevel(difficultyLevel) ng-class="{\n                          \'main__elastic__list__item--active\': main.isDifficultyLevel(difficultyLevel),\n                          \'main__elastic__list__item--reduced\': !main.matchDifficultyLevel(difficultyLevel)\n                        }">{{ main.administrativeLevels[difficultyLevel - 1] }}</button></li></ul></div></div><div class=col-xs-4><div class=card><h4 class="card-heading main__elastic__title"><button class="btn btn-link btn-sm pull-xs-right" ng-click=main.resetTerm() ng-if=main.hasTerm()>All</button> Term</h4><ul class="list-unstyled main__elastic__list main__elastic__list--term"><li ng-repeat="term in ::main.terms"><button class="btn btn-primary btn-xs btn-block main__elastic__list__item" ng-click=main.toggleTerm(term) ng-class="{\n                          \'main__elastic__list__item--active\': main.isTerm(term),\n                          \'main__elastic__list__item--reduced\': !main.matchTerm(term)\n                        }">{{ term }}</button></li></ul></div></div></div><ul><li ng-repeat="legislature in main.getFilteredLegislatures()">{{ legislature.name }}</li></ul></div></form><!--\n  <div class="text-center main__heading">\n    <h2 class="main__heading__title">\n      Political Gaps\n    </h2>\n    <p class="main__heading__title__description">\n      How representative are our representatives?\n    </p>\n\n    <form class="main__heading__legislatures form-inline">\n      <label>\n        Diversity report for\n        <select class="form-control"\n                ng-options="legislature.id as legislature.display_name group by legislature.country.name for legislature in main.legislatures"\n                ng-model="main.legislature">\n        </select>\n      </label>\n    </form>\n    <br />\n    <ul class="nav nav-pills main__heading__tabs">\n      <li class="nav-item">\n        <a class="nav-link" ui-sref="main({topic: \'gender\'})" ui-sref-active="active">\n          Gender\n        </a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" ui-sref="main({topic: \'age_range\'})" ui-sref-active="active">\n          Age\n        </a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" ui-sref="main({topic: \'profession_category\'})" ui-sref-active="active">\n          Occupation\n        </a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" ui-sref="main({topic: \'political_leaning\'})" ui-sref-active="active">\n          Political leaning\n        </a>\n      </li>\n    </ul>\n\n  </div>\n  <div class="main__chart main__chart--{{ main.topic }}" ui-view main-chart="main.summary" topic="main.topic"></div>\n--></div>')}]);
//# sourceMappingURL=../maps/scripts/app-bae5cc881b.js.map
